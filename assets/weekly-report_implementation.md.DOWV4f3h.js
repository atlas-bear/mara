import{_ as i,c as a,o as n,ag as e}from"./chunks/framework.BONmpqY0.js";const c=JSON.parse('{"title":"Weekly Report Implementation","description":"","frontmatter":{},"headers":[],"relativePath":"weekly-report/implementation.md","filePath":"weekly-report/implementation.md"}'),t={name:"weekly-report/implementation.md"};function l(p,s,h,k,r,o){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="weekly-report-implementation" tabindex="-1">Weekly Report Implementation <a class="header-anchor" href="#weekly-report-implementation" aria-label="Permalink to &quot;Weekly Report Implementation&quot;">​</a></h1><p>This document provides technical details on the implementation of the Weekly Report feature.</p><h2 id="component-structure" tabindex="-1">Component Structure <a class="header-anchor" href="#component-structure" aria-label="Permalink to &quot;Component Structure&quot;">​</a></h2><p>The Weekly Report is built using a hierarchical component structure:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>WeeklyReportPage</span></span>
<span class="line"><span>├── ExecutiveBrief</span></span>
<span class="line"><span>│   ├── Global Threat Overview</span></span>
<span class="line"><span>│   ├── Key Developments (AI-generated)</span></span>
<span class="line"><span>│   └── 7-Day Forecast (AI-generated)</span></span>
<span class="line"><span>├── RegionalBrief (for each region)</span></span>
<span class="line"><span>│   ├── Regional Map</span></span>
<span class="line"><span>│   ├── Threat Assessment</span></span>
<span class="line"><span>│   └── Regional Statistics</span></span>
<span class="line"><span>└── IncidentDetails (for each incident)</span></span>
<span class="line"><span>    ├── Incident Map</span></span>
<span class="line"><span>    ├── Vessel Information</span></span>
<span class="line"><span>    └── Incident Description</span></span></code></pre></div><h2 id="file-structure" tabindex="-1">File Structure <a class="header-anchor" href="#file-structure" aria-label="Permalink to &quot;File Structure&quot;">​</a></h2><p>Key files in the implementation:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/src/shared/features/weekly-report/</span></span>
<span class="line"><span>├── components/</span></span>
<span class="line"><span>│   ├── ExecutiveBrief/</span></span>
<span class="line"><span>│   │   └── index.jsx               # Executive summary component</span></span>
<span class="line"><span>│   ├── RegionalBrief/</span></span>
<span class="line"><span>│   │   └── index.jsx               # Regional analysis component</span></span>
<span class="line"><span>│   └── IncidentDetails/</span></span>
<span class="line"><span>│       └── index.jsx               # Incident details component</span></span>
<span class="line"><span>├── utils/</span></span>
<span class="line"><span>│   ├── dates.js                    # Date handling functions</span></span>
<span class="line"><span>│   ├── report-data.js              # Data fetching and state management</span></span>
<span class="line"><span>│   ├── client-api.js               # Client-side API calls</span></span>
<span class="line"><span>│   └── trend-api.js                # Historical trend data access</span></span>
<span class="line"><span>└── index.js                        # Feature exports</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/functions/</span></span>
<span class="line"><span>├── get-weekly-incidents.js         # Serverless function for incident data</span></span>
<span class="line"><span>├── get-weekly-report-content.js    # On-demand report content generation</span></span>
<span class="line"><span>├── get-weekly-report-content-background.js # Scheduled content generation</span></span>
<span class="line"><span>├── send-weekly-report-notification.js # Scheduled email notification (Tuesdays)</span></span>
<span class="line"><span>├── test-weekly-notification.js     # Test endpoint for email notifications</span></span>
<span class="line"><span>└── utils/</span></span>
<span class="line"><span>    ├── weekly-report-cache.js      # 7-day caching implementation</span></span>
<span class="line"><span>    ├── llm-service.js              # AI service integration</span></span>
<span class="line"><span>    └── supabase.js                 # Database access including user subscriptions</span></span></code></pre></div><h2 id="client-side-components" tabindex="-1">Client-Side Components <a class="header-anchor" href="#client-side-components" aria-label="Permalink to &quot;Client-Side Components&quot;">​</a></h2><h3 id="executivebrief" tabindex="-1">ExecutiveBrief <a class="header-anchor" href="#executivebrief" aria-label="Permalink to &quot;ExecutiveBrief&quot;">​</a></h3><p>The <code>ExecutiveBrief</code> component provides a high-level overview of maritime security:</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExecutiveBrief</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  incidents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{incidents} </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{start} </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  end</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{end}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  yearWeek</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{activeYearWeek}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>Key features:</p><ul><li>Displays week number and date range</li><li>Shows interactive map of all incidents</li><li>Presents threat levels by region</li><li>Displays AI-generated key developments</li><li>Shows AI-generated 7-day forecast</li></ul><h3 id="regionalbrief" tabindex="-1">RegionalBrief <a class="header-anchor" href="#regionalbrief" aria-label="Permalink to &quot;RegionalBrief&quot;">​</a></h3><p>The <code>RegionalBrief</code> component provides region-specific analysis:</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RegionalBrief</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  incidents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{regionIncidents}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  latestIncidents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ [region]: latestRegionIncident }}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  currentRegion</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{region}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{start} </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  end</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{end}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>When no incidents occur in a region during the reporting period, the RegionalBrief will display the most recent historical incident from that region, clearly labeled as &quot;Historical incident - Most recent in this region&quot;. The system only shows historical incidents that occurred on or before the end date of the reporting period.</p><h3 id="incidentdetails" tabindex="-1">IncidentDetails <a class="header-anchor" href="#incidentdetails" aria-label="Permalink to &quot;IncidentDetails&quot;">​</a></h3><p>The <code>IncidentDetails</code> component shows detailed information for a specific incident:</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IncidentDetails</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  incident</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{incident}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  showHistoricalContext</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  useInteractiveMap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Uses StaticMap by default to avoid WebGL context limits</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>The <code>useInteractiveMap</code> prop determines which map component to use:</p><ul><li><code>false</code> (default): Uses the lightweight StaticMap component (recommended for Weekly Reports)</li><li><code>true</code>: Uses the interactive MaritimeMap component (used in Flash Reports)</li></ul><h2 id="serverless-functions" tabindex="-1">Serverless Functions <a class="header-anchor" href="#serverless-functions" aria-label="Permalink to &quot;Serverless Functions&quot;">​</a></h2><h3 id="get-weekly-incidents-js" tabindex="-1">get-weekly-incidents.js <a class="header-anchor" href="#get-weekly-incidents-js" aria-label="Permalink to &quot;get-weekly-incidents.js&quot;">​</a></h3><p>Retrieves incidents for a specified date range from the data source:</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Example request</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.netlify</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">functions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">get</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weekly</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">incidents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">17</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T21</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Z</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">24</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Z</span></span></code></pre></div><h3 id="get-weekly-report-content-js" tabindex="-1">get-weekly-report-content.js <a class="header-anchor" href="#get-weekly-report-content-js" aria-label="Permalink to &quot;get-weekly-report-content.js&quot;">​</a></h3><p>On-demand generation of AI content for the weekly report:</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Example request</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.netlify</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">functions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">get</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weekly</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">report</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">17</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T21</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Z</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">24</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Z</span></span></code></pre></div><p>Response format:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;keyDevelopments&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;region&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;West Africa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;level&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;orange&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // More developments...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;forecast&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;region&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Southeast Asia&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;trend&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;up&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // More forecasts...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="get-weekly-report-content-background-js" tabindex="-1">get-weekly-report-content-background.js <a class="header-anchor" href="#get-weekly-report-content-background-js" aria-label="Permalink to &quot;get-weekly-report-content-background.js&quot;">​</a></h3><p>Scheduled function that runs every Monday at 21:00 UTC to generate and cache weekly report content for the period that just ended.</p><h3 id="send-weekly-report-notification-js" tabindex="-1">send-weekly-report-notification.js <a class="header-anchor" href="#send-weekly-report-notification-js" aria-label="Permalink to &quot;send-weekly-report-notification.js&quot;">​</a></h3><p>Scheduled function that runs every Tuesday at 08:00 UTC to send email notifications about the newly available weekly report to subscribed users.</p><h3 id="test-weekly-notification-js" tabindex="-1">test-weekly-notification.js <a class="header-anchor" href="#test-weekly-notification-js" aria-label="Permalink to &quot;test-weekly-notification.js&quot;">​</a></h3><p>Testing endpoint for manually triggering weekly report email notifications without waiting for the scheduled run.</p><h2 id="caching-implementation" tabindex="-1">Caching Implementation <a class="header-anchor" href="#caching-implementation" aria-label="Permalink to &quot;Caching Implementation&quot;">​</a></h2><p>The Weekly Report uses a 7-day caching strategy to optimize performance:</p><ol><li>The background function generates content every Monday at 21:00 UTC</li><li>Content is stored in Netlify Blob Storage with a 7-day TTL</li><li>Client requests check the cache first</li><li>If no cache exists, the on-demand function generates the content</li></ol><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Cache key format</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weeklyReportCache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(startDate.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toISOString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), endDate.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toISOString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span></code></pre></div><h2 id="multi-tenant-support" tabindex="-1">Multi-Tenant Support <a class="header-anchor" href="#multi-tenant-support" aria-label="Permalink to &quot;Multi-Tenant Support&quot;">​</a></h2><p>The implementation supports white-labeled client applications:</p><ol><li>Core components are in the shared features directory</li><li>Client-specific styling is applied in client applications</li><li>Company branding is dynamically applied through a branding provider</li></ol><h2 id="testing" tabindex="-1">Testing <a class="header-anchor" href="#testing" aria-label="Permalink to &quot;Testing&quot;">​</a></h2><p>Test the Weekly Report feature:</p><ol><li>Verify date calculations with <code>?debug=true</code> parameter</li><li>Test cache operations with <code>?testCache=true</code> parameter</li><li>Manually trigger the background function for testing</li></ol>`,48)]))}const g=i(t,[["render",l]]);export{c as __pageData,g as default};
