<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Data Processing System | MARA Documentation</title>
    <meta name="description" content="Documentation for the Maritime Risk Analysis system">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/mara/assets/style.B9amjzLO.css" as="style">
    <link rel="preload stylesheet" href="/mara/vp-icons.css" as="style">
    
    <script type="module" src="/mara/assets/app.DyBrfPQ7.js"></script>
    <link rel="preload" href="/mara/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/mara/assets/chunks/theme.JX4UXoWB.js">
    <link rel="modulepreload" href="/mara/assets/chunks/framework.BONmpqY0.js">
    <link rel="modulepreload" href="/mara/assets/data-pipeline_data-processing.md.CAqa2APE.lean.js">
    <link rel="icon" href="https://drive.google.com/uc?id=1OB5Lwgpp03DB9vs50T_kkKzL5VV_y5Eo" type="image/png">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/mara/" data-v-9f43907a><!--[--><!--]--><!--[--><img class="VPImage logo" src="https://drive.google.com/uc?id=1OB5Lwgpp03DB9vs50T_kkKzL5VV_y5Eo" alt data-v-ab19afbb><!--]--><span data-v-9f43907a>MARA Documentation</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mara/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mara/guide/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Guide</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mara/components/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Components</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mara/data-pipeline/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Data Pipeline</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mara/deduplication/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Deduplication</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mara/ai-integration/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>AI Integration</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mara/flash-report/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Flash Reports</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mara/weekly-report/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Weekly Reports</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mara/api/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>API</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/atlas-bear/mara" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/atlas-bear/mara" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 has-active" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Data Pipeline</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/mara/data-pipeline/" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/mara/data-pipeline/data-collection.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Data Collection</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/mara/data-pipeline/data-processing.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Data Processing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/mara/data-pipeline/troubleshooting.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Troubleshooting</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _mara_data-pipeline_data-processing" data-v-e6f2a212><div><h1 id="data-processing-system" tabindex="-1">Data Processing System <a class="header-anchor" href="#data-processing-system" aria-label="Permalink to &quot;Data Processing System&quot;">​</a></h1><p>The MARA data processing system transforms deduplicated raw incident data into structured, enriched incident records through intelligent analysis and standardization. This critical pipeline stage creates the high-quality incident data that powers MARA&#39;s reporting and analytics capabilities.</p><h2 id="processing-functions" tabindex="-1">Processing Functions <a class="header-anchor" href="#processing-functions" aria-label="Permalink to &quot;Processing Functions&quot;">​</a></h2><p>The data processing stage consists of two main functions that work in sequence:</p><ol><li><strong><code>process-raw-data-background.js</code></strong>: Processes individual raw data records into structured incident records</li><li><strong><code>process-incidents.js</code></strong>: Performs batch processing of incidents and additional post-processing tasks</li></ol><h2 id="processing-workflow" tabindex="-1">Processing Workflow <a class="header-anchor" href="#processing-workflow" aria-label="Permalink to &quot;Processing Workflow&quot;">​</a></h2><p>The complete data processing workflow consists of:</p><ol><li><strong>Raw Data Selection</strong>: Identify unprocessed records from the <code>raw_data</code> table</li><li><strong>Processing Status Update</strong>: Mark selected record as &quot;Processing&quot;</li><li><strong>Data Normalization</strong>: Standardize data formats and clean input</li><li><strong>AI-Powered Analysis</strong>: Generate enriched analysis using Claude AI</li><li><strong>Incident Creation</strong>: Create structured incident record</li><li><strong>Vessel Processing</strong>: Create or link to vessel records</li><li><strong>Related Data Creation</strong>: Create reference entries for incident attributes</li><li><strong>Processing Completion</strong>: Mark raw data as processed and link to created incident</li><li><strong>Continuation</strong>: Check for more records to process</li></ol><h2 id="detailed-process-flow" tabindex="-1">Detailed Process Flow <a class="header-anchor" href="#detailed-process-flow" aria-label="Permalink to &quot;Detailed Process Flow&quot;">​</a></h2><h3 id="raw-data-selection" tabindex="-1">Raw Data Selection <a class="header-anchor" href="#raw-data-selection" aria-label="Permalink to &quot;Raw Data Selection&quot;">​</a></h3><p>The <code>process-raw-data-background.js</code> function selects unprocessed records using this criteria:</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> filterByFormula</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AND(NOT({has_incident}), OR(NOT({processing_status}), {processing_status} = &#39;pending&#39;))&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>This ensures that:</p><ul><li>Only records without existing incidents are processed</li><li>Only records that aren&#39;t already being processed are selected</li></ul><h3 id="ai-powered-enrichment" tabindex="-1">AI-Powered Enrichment <a class="header-anchor" href="#ai-powered-enrichment" aria-label="Permalink to &quot;AI-Powered Enrichment&quot;">​</a></h3><p>A key feature of the processing system is the integration with Claude AI to enhance incident data:</p><ol><li><strong>Context Assembly</strong>: Builds a detailed prompt with incident information</li><li><strong>API Integration</strong>: Calls Claude with specialized instructions</li><li><strong>Description Enhancement</strong>: Standardizes and improves incident descriptions with maritime terminology</li><li><strong>Analysis Generation</strong>: Creates insightful analysis of the maritime incident</li><li><strong>Data Extraction</strong>: Extracts structured data about weapons, attackers, stolen items, etc.</li><li><strong>Title Generation</strong>: Creates a concise but descriptive incident title</li></ol><p>The system uses a carefully designed prompt that instructs Claude to:</p><ul><li>Create a concise incident title (max 10 words)</li><li>Extract location information if missing</li><li>Rephrase and standardize the incident description for clarity and consistency <ul><li>Apply proper nautical terminology (e.g., &quot;aboard&quot; instead of &quot;on&quot; a ship)</li><li>Standardize abbreviations (e.g., &quot;NM&quot; for nautical miles)</li><li>Use title case for vessel types (e.g., &quot;Bulk Carrier&quot;, &quot;Container Ship&quot;)</li><li>Properly introduce acronyms on first use (e.g., &quot;UK Maritime Trade Operations (UKMTO)&quot;)</li><li>Improve text formatting with appropriate paragraph breaks</li></ul></li><li>Identify weapons mentioned in the description</li><li>Provide insightful analysis (1-2 paragraphs)</li><li>Create actionable security recommendations (2-3 bullet points)</li><li>Extract specific details in structured format <ul><li>Weapons used</li><li>Number of attackers</li><li>Items stolen</li><li>Response type</li><li>Authorities notified</li></ul></li></ul><h3 id="standardization-through-reference-data" tabindex="-1">Standardization Through Reference Data <a class="header-anchor" href="#standardization-through-reference-data" aria-label="Permalink to &quot;Standardization Through Reference Data&quot;">​</a></h3><p>The system maintains standardized categorization through reference tables:</p><ol><li><strong>Incident Types</strong>: The system matches to known incident types or creates new ones</li><li><strong>Weapons</strong>: Standardized weapon categories for consistent reporting</li><li><strong>Items Stolen</strong>: Categorization of stolen property</li><li><strong>Response Types</strong>: Standard response classifications</li><li><strong>Authorities Notified</strong>: Standardized authority references</li></ol><p>For each reference category, the system:</p><ol><li>Checks if the item exists in the reference table</li><li>Creates it if it doesn&#39;t exist</li><li>Links the incident to the reference items</li></ol><h3 id="vessel-data-processing" tabindex="-1">Vessel Data Processing <a class="header-anchor" href="#vessel-data-processing" aria-label="Permalink to &quot;Vessel Data Processing&quot;">​</a></h3><p>The system handles vessel information with special care:</p><ol><li><strong>Vessel Lookup</strong>: Checks if vessel exists by name or IMO</li><li><strong>Vessel Creation</strong>: Creates new vessel record if needed</li><li><strong>Incident-Vessel Linking</strong>: Creates relationship in the <code>incident_vessel</code> join table</li><li><strong>Status Determination</strong>: Determines vessel status during incident: <ul><li>Parses status from raw data</li><li>Extracts from description if not explicit</li><li>Maps to standardized values (Anchored, Underway, Moored, etc.)</li></ul></li></ol><h3 id="processing-continuation" tabindex="-1">Processing Continuation <a class="header-anchor" href="#processing-continuation" aria-label="Permalink to &quot;Processing Continuation&quot;">​</a></h3><p>To handle large volumes efficiently, the system implements a self-triggering mechanism:</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Check if more records exist to process</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> moreRecords</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> checkMoreRecordsExist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rawDataUrl, headers);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (moreRecords) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Trigger another processing run via API call</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> siteUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://mara-v2.netlify.app&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> axios.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">post</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">siteUrl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/.netlify/functions/process-raw-data-background`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (triggerError) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Failed to trigger next processing job&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, triggerError.message);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>This allows continuous processing until all raw data has been processed.</p><h2 id="error-handling-and-resilience" tabindex="-1">Error Handling and Resilience <a class="header-anchor" href="#error-handling-and-resilience" aria-label="Permalink to &quot;Error Handling and Resilience&quot;">​</a></h2><p>The processing system implements robust error handling:</p><ol><li><strong>Transaction Isolation</strong>: Each record is processed independently</li><li><strong>State Tracking</strong>: Processing status is updated at each stage</li><li><strong>Detailed Logging</strong>: Comprehensive error information for troubleshooting</li><li><strong>Graceful Degradation</strong>: Falls back to simpler processing if advanced features fail</li><li><strong>Retry Mechanism</strong>: Failed records can be reprocessed</li></ol><h2 id="scheduling-and-execution" tabindex="-1">Scheduling and Execution <a class="header-anchor" href="#scheduling-and-execution" aria-label="Permalink to &quot;Scheduling and Execution&quot;">​</a></h2><p>The processing function is scheduled to run after collection and deduplication:</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">functions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;process-incidents&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">schedule = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;25,55 * * * *&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 25 and 55 minutes past the hour</span></span></code></pre></div><p>Additionally, it&#39;s triggered on-demand after the deduplication function completes.</p><h2 id="system-extensions" tabindex="-1">System Extensions <a class="header-anchor" href="#system-extensions" aria-label="Permalink to &quot;System Extensions&quot;">​</a></h2><p>The processing system can be extended in several ways:</p><ol><li><strong>Additional AI Enrichment</strong>: Adding more advanced analysis capabilities</li><li><strong>Enhanced Categorization</strong>: Expanding reference data categories</li><li><strong>Custom Processing Rules</strong>: Adding source-specific or region-specific processing</li><li><strong>Improved Vessel Linking</strong>: Enhanced vessel identification and metadata extraction</li><li><strong>Post-Processing Analysis</strong>: Additional intelligence generation after incident creation</li></ol><h2 id="technical-considerations" tabindex="-1">Technical Considerations <a class="header-anchor" href="#technical-considerations" aria-label="Permalink to &quot;Technical Considerations&quot;">​</a></h2><h3 id="performance-optimization" tabindex="-1">Performance Optimization <a class="header-anchor" href="#performance-optimization" aria-label="Permalink to &quot;Performance Optimization&quot;">​</a></h3><p>The processing system optimizes performance through:</p><ol><li><strong>Batched API Calls</strong>: Reduces latency by combining related operations</li><li><strong>Incremental Processing</strong>: Processes records in small batches</li><li><strong>Cached Lookups</strong>: Minimizes redundant database queries</li><li><strong>Self-Throttling</strong>: Prevents resource exhaustion during peak loads</li></ol><h3 id="data-quality-assurance" tabindex="-1">Data Quality Assurance <a class="header-anchor" href="#data-quality-assurance" aria-label="Permalink to &quot;Data Quality Assurance&quot;">​</a></h3><p>Several mechanisms ensure data quality:</p><ol><li><strong>Validation</strong>: Input data is validated before processing</li><li><strong>Normalization</strong>: Dates, coordinates, and text are standardized</li><li><strong>AI Review</strong>: Claude provides a secondary check on data consistency</li><li><strong>Reference Standards</strong>: Use of reference tables ensures consistent categorization</li><li><strong>Field Verification</strong>: Required fields are verified before saving</li></ol><h2 id="monitoring-and-troubleshooting" tabindex="-1">Monitoring and Troubleshooting <a class="header-anchor" href="#monitoring-and-troubleshooting" aria-label="Permalink to &quot;Monitoring and Troubleshooting&quot;">​</a></h2><p>The processing system provides comprehensive monitoring:</p><ol><li><strong>Progress Logging</strong>: Detailed logs of each processing stage</li><li><strong>Status Tracking</strong>: Record status in the <code>raw_data</code> table</li><li><strong>Performance Metrics</strong>: Execution time and resource usage tracking</li><li><strong>Error Categorization</strong>: Specific error types for targeted fixing</li><li><strong>Debugging Tools</strong>: Special debugging endpoints for testing</li></ol></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/mara/data-pipeline/data-collection.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>Data Collection</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/mara/data-pipeline/troubleshooting.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>Troubleshooting</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><p class="message" data-v-566314d4>Released under the Internal License.</p><p class="copyright" data-v-566314d4>Copyright © 2023-present Atlas Bear</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"ai-integration_index.md\":\"BWIGsJbD\",\"ai-integration_prompts-system.md\":\"vAOKjWg4\",\"api_authentication.md\":\"CGk9SOU3\",\"api_endpoints_incidents.md\":\"CkibLASL\",\"api_error-codes.md\":\"DsNPeTXt\",\"api_index.md\":\"sAuSpiKG\",\"api_rate-limits.md\":\"B4wBgKsp\",\"components_index.md\":\"z6P4EwWW\",\"components_maritime-map.md\":\"DsDdmsAy\",\"components_pdf-download-button.md\":\"CcC59VUh\",\"components_static-map.md\":\"CDnaQayq\",\"data-pipeline_data-collection.md\":\"CbZdQQLF\",\"data-pipeline_data-processing.md\":\"CAqa2APE\",\"data-pipeline_index.md\":\"BOniQ1fr\",\"data-pipeline_troubleshooting.md\":\"CtiwH0un\",\"deduplication_implementation.md\":\"BAAmcQsL\",\"deduplication_index.md\":\"C7zfcAZp\",\"deduplication_troubleshooting.md\":\"PtRIcf3o\",\"flash-report_api-reference.md\":\"DX7nNuEi\",\"flash-report_architecture.md\":\"D9pKX3Bx\",\"flash-report_automation-system.md\":\"BLSa-nBa\",\"flash-report_cache-implementation.md\":\"tfbQ2NDL\",\"flash-report_index.md\":\"C6kP9rww\",\"flash-report_integration-guide.md\":\"GYTWCc7u\",\"flash-report_overview.md\":\"CN0N7mJh\",\"flash-report_testing-guide.md\":\"CBB-LXAO\",\"guide_architecture.md\":\"B80Pkxob\",\"guide_deployment.md\":\"DaPtdKUc\",\"guide_getting-started.md\":\"D-L5WWZw\",\"guide_index.md\":\"DvzUFPSs\",\"guide_installation.md\":\"Cntmt2Id\",\"index.md\":\"bvp_W4hb\",\"migration-plan.md\":\"BhyYEMxd\",\"readme.md\":\"CDH59HGp\",\"weekly-report_api-reference.md\":\"BTIZ2Xio\",\"weekly-report_data-flow.md\":\"B5S51BWm\",\"weekly-report_date-handling.md\":\"CRq9457T\",\"weekly-report_email-notifications.md\":\"D3hw4C-v\",\"weekly-report_implementation.md\":\"DOWV4f3h\",\"weekly-report_index.md\":\"Ir_PtMFG\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"MARA Documentation\",\"description\":\"Documentation for the Maritime Risk Analysis system\",\"base\":\"/mara/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"https://drive.google.com/uc?id=1OB5Lwgpp03DB9vs50T_kkKzL5VV_y5Eo\",\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Guide\",\"link\":\"/guide/\"},{\"text\":\"Components\",\"link\":\"/components/\"},{\"text\":\"Data Pipeline\",\"link\":\"/data-pipeline/\"},{\"text\":\"Deduplication\",\"link\":\"/deduplication/\"},{\"text\":\"AI Integration\",\"link\":\"/ai-integration/\"},{\"text\":\"Flash Reports\",\"link\":\"/flash-report/\"},{\"text\":\"Weekly Reports\",\"link\":\"/weekly-report/\"},{\"text\":\"API\",\"link\":\"/api/\"}],\"sidebar\":{\"/guide/\":[{\"text\":\"Introduction\",\"items\":[{\"text\":\"Getting Started\",\"link\":\"/guide/getting-started\"},{\"text\":\"Architecture\",\"link\":\"/guide/architecture\"},{\"text\":\"Installation\",\"link\":\"/guide/installation\"},{\"text\":\"Deployment\",\"link\":\"/guide/deployment\"}]}],\"/components/\":[{\"text\":\"UI Components\",\"items\":[{\"text\":\"Overview\",\"link\":\"/components/\"},{\"text\":\"PDF Download Button\",\"link\":\"/components/pdf-download-button\"},{\"text\":\"Maritime Map\",\"link\":\"/components/maritime-map\"}]}],\"/data-pipeline/\":[{\"text\":\"Data Pipeline\",\"items\":[{\"text\":\"Overview\",\"link\":\"/data-pipeline/\"},{\"text\":\"Data Collection\",\"link\":\"/data-pipeline/data-collection\"},{\"text\":\"Data Processing\",\"link\":\"/data-pipeline/data-processing\"},{\"text\":\"Troubleshooting\",\"link\":\"/data-pipeline/troubleshooting\"}]}],\"/deduplication/\":[{\"text\":\"Cross-Source Deduplication\",\"items\":[{\"text\":\"Overview\",\"link\":\"/deduplication/\"},{\"text\":\"Implementation\",\"link\":\"/deduplication/implementation\"},{\"text\":\"Troubleshooting\",\"link\":\"/deduplication/troubleshooting\"}]}],\"/flash-report/\":[{\"text\":\"Flash Reports\",\"items\":[{\"text\":\"Overview\",\"link\":\"/flash-report/\"},{\"text\":\"API Reference\",\"link\":\"/flash-report/api-reference\"},{\"text\":\"Architecture\",\"link\":\"/flash-report/architecture\"},{\"text\":\"Automation\",\"link\":\"/flash-report/automation-system\"},{\"text\":\"Cache Implementation\",\"link\":\"/flash-report/cache-implementation\"},{\"text\":\"Integration Guide\",\"link\":\"/flash-report/integration-guide\"},{\"text\":\"Testing Guide\",\"link\":\"/flash-report/testing-guide\"}]}],\"/weekly-report/\":[{\"text\":\"Weekly Reports\",\"items\":[{\"text\":\"Overview\",\"link\":\"/weekly-report/\"},{\"text\":\"Implementation\",\"link\":\"/weekly-report/implementation\"},{\"text\":\"Date Handling\",\"link\":\"/weekly-report/date-handling\"},{\"text\":\"Data Flow\",\"link\":\"/weekly-report/data-flow\"},{\"text\":\"API Reference\",\"link\":\"/weekly-report/api-reference\"},{\"text\":\"Email Notifications\",\"link\":\"/weekly-report/email-notifications\"}]}],\"/ai-integration/\":[{\"text\":\"AI Integration\",\"items\":[{\"text\":\"Overview\",\"link\":\"/ai-integration/\"},{\"text\":\"Prompts System\",\"link\":\"/ai-integration/prompts-system\"}]}],\"/api/\":[{\"text\":\"API Reference\",\"items\":[{\"text\":\"Overview\",\"link\":\"/api/\"},{\"text\":\"Authentication\",\"link\":\"/api/authentication\"},{\"text\":\"Rate Limits\",\"link\":\"/api/rate-limits\"},{\"text\":\"Error Codes\",\"link\":\"/api/error-codes\"},{\"text\":\"Endpoints\",\"collapsed\":false,\"items\":[{\"text\":\"Incidents\",\"link\":\"/api/endpoints/incidents\"},{\"text\":\"Reports\",\"link\":\"/api/endpoints/reports\"},{\"text\":\"Hotspots\",\"link\":\"/api/endpoints/hotspots\"},{\"text\":\"Countries\",\"link\":\"/api/endpoints/countries\"},{\"text\":\"Ports\",\"link\":\"/api/endpoints/ports\"}]}]}]},\"footer\":{\"message\":\"Released under the Internal License.\",\"copyright\":\"Copyright © 2023-present Atlas Bear\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/atlas-bear/mara\"}],\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>